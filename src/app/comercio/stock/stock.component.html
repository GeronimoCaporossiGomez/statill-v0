<div class="pagina-stock">
  <aside class="stock-sidebar">
    <app-sidebar></app-sidebar>
  </aside>

  <section class="stock-content">
    <header class="stock-hero">
      <div class="hero-text">
        <span class="badge">Gesti√≥n de cat√°logo</span>
        <h1>Productos de tu tienda</h1>
        <p>
          Cre√° y actualiz√° los productos disponibles en tu local. Control√° precios, stock y visibilidad desde un solo lugar.
        </p>
      </div>
      <div class="hero-metrics">
        <div class="metric">
          <span class="metric-value">{{ totalProductos }}</span>
          <span class="metric-label">productos activos</span>
        </div>
        <div class="metric">
          <span class="metric-value">{{ totalUnidades }}</span>
          <span class="metric-label">unidades en stock</span>
        </div>
      </div>
    </header>

    <div class="cta-card">
      <div class="cta-icon">
        {{ SePuedeVerElformulario ? "üõ†Ô∏è" : "‚ú®" }}
      </div>
      <div class="cta-content">
        <h2>
          {{ SePuedeVerElformulario ? "Edit√° el producto seleccionado" : "A√±ad√≠ un nuevo producto" }}
        </h2>
        <p>
          Carg√° los datos principales, agreg√° una imagen y manten√© actualizado tu cat√°logo para que los clientes vean productos reales.
        </p>
      </div>
      <button class="cta-button" type="button" (click)="FormChange()">
        {{ SePuedeVerElformulario ? "Cerrar formulario" : "Agregar producto" }}
      </button>
    </div>

    <div class="form-wrapper" [class.visible]="SePuedeVerElformulario">
      <app-producto-form
        [producto]="producto"
        [isLoading]="isLoading"
        [errorMessage]="errorMessage"
        [showForm]="SePuedeVerElformulario"
        [title]="productoEditandoId ? 'Editar Producto' : 'Crear Producto'"
        [submitButtonText]="
          productoEditandoId ? 'Actualizar Producto' : 'Crear Producto'
        "
        [showBarcodeField]="true"
        [showStoreIdField]="false"
        [suggestedData]="null"
        (onSubmit)="onProductoSubmit($event)"
        (onCancel)="onCancelar()"
        (onReset)="onReset()"
        (onUseSuggestedData)="onUseSuggestedData($event)"
        (onFileSelected)="onFileSelected($event)"
      >
      </app-producto-form>
    </div>

    <section class="productos-panel" *ngIf="!SePuedeVerElformulario">
      <header class="panel-header">
        <h2>Cat√°logo actual</h2>
        <p>Seleccion√° un producto para editarlo r√°pidamente.</p>
      </header>

      <div class="productos-grid">
        <article
          class="producto-card"
          *ngFor="let producto of productos; let i = index"
        >
          <div class="producto-media">
            <img
              *ngIf="producto.img"
              [src]="producto.img"
              alt="Imagen de {{ producto.name }}"
            />
            <div *ngIf="!producto.img" class="img-placeholder">
              <span>üñºÔ∏è</span>
            </div>
          </div>

          <div class="producto-body">
            <h3>{{ producto.name }}</h3>
            <p class="producto-desc">
              {{ producto.desc || "Sin descripci√≥n" }}
            </p>
            <div class="producto-meta">
              <span class="stock-chip">
                Stock: <strong>{{ producto.quantity || 0 }}</strong>
              </span>
              <span class="price-chip">
                Precio: <strong>${{ producto.price }}</strong>
              </span>
            </div>
          </div>

          <div class="producto-actions">
            <button class="edit-btn" type="button" (click)="onEdit(producto, i)">
              Editar
            </button>
          </div>
        </article>
      </div>

      <div *ngIf="productos.length === 0" class="empty-state">
        <div class="empty-icon">üì¶</div>
        <h3>Sin productos cargados</h3>
        <p>Comenz√° agregando tu primer producto para que aparezca aqu√≠.</p>
      </div>
    </section>
  </section>
</div>

<div class="pagina-estadisticas">
  <app-sidebar></app-sidebar>
  <div class="estadisticas-card">
    <div class="estadisticas-controls">
      <!-- ✅ Mostrar selector de producto solo cuando sea necesario -->
      <ng-container
        *ngIf="
          statTypeControl.value !== 'fidelidad_clientes' &&
          statTypeControl.value !== 'ventas_por_dia' &&
          statTypeControl.value !== 'dinero_por_dia'
        "
      >
        <h2 class="estadisticas-title">
          {{ statTypeControl.value === 'ganancias_por_producto' ? 'Producto (opcional):' : 'Producto:' }}
        </h2>
        <select [formControl]="productControl" class="estadisticas-select">
          <option value="">
            {{ statTypeControl.value === 'ganancias_por_producto' ? 'Todos los productos' : 'Seleccione producto' }}
          </option>
          <option *ngFor="let product of products" [value]="product.id">
            {{ product.name }}
          </option>
        </select>
      </ng-container>

      <h2 class="estadisticas-title">Tipo de gráfico:</h2>
      <select [formControl]="statTypeControl" class="estadisticas-select">
        <option value="ventas_en_el_tiempo">
          Cantidad Vendida en el Tiempo
        </option>
        <option value="metodos_pago">Métodos de Pago Usados</option>
        <option value="productos_junto">Productos que se venden junto</option>
        <option value="ganancias_por_producto">Ganancias por Producto</option>
        <option value="fidelidad_clientes">
          Fidelidad de Clientes (Gasto Total y Promedio)
        </option>
        <option value="ventas_por_dia">Ventas por Día</option>
        <option value="dinero_por_dia">Dinero Generado por Día</option>
      </select>

      <div class="estadisticas-fechas">
        <input
          type="date"
          [formControl]="startDateControl"
          class="estadisticas-date"
          placeholder="Fecha inicio"
        />
        <input
          type="date"
          [formControl]="endDateControl"
          class="estadisticas-date"
          placeholder="Fecha fin"
        />
      </div>

      <button class="btn-hacer-grafico" (click)="cargarVentas()">
        Hacer gráfico
      </button>
    </div>
    <div class="estadisticas-chart-container">
      <canvas #chartCanvas></canvas>
    </div>
  </div>
</div>
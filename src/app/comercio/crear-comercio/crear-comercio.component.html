<app-sidebar></app-sidebar>

<!-- Pantalla inicial -->
<div class="contenedor" *ngIf="seccionPantalla == 0">
  <button type="button">
    <a routerLink="/escanear">Ir a escanear de una</a>
  </button>
  <h1>¡Hola vendedor!</h1>
  <h2>¿Que querés hacer?</h2>
  <button class="boton" type="button" (click)="creandoComercio(true); seccionPantalla=1">Crear comercio</button>
  <button class="boton" type="button" (click)="creandoComercio(false)">Unirme a un comercio</button>
</div>

<!-- Formulario de creación -->
<div *ngIf="creando">
  <form (ngSubmit)="onSubmit(comercioForm)" #comercioForm="ngForm">

    <!-- PANTALLA 1 -->
    <div [style.display]="seccionPantalla == 1 ? 'block' : 'none'" class="seccion-creando">
      <div class="primera-parte">

        <h3>Id locala</h3>
        <input type="number" name="localsito" ngModel placeholder="1">

        <h3>Nombre</h3>
        <input type="text" name="nombre" ngModel placeholder="Nombre del local">

        <h3>Logo</h3>
        <input type="file" (change)="mostrarImagen($event)">
        <div id="caja-blanca" *ngIf="imagenUrl">
          <img [src]="imagenUrl" alt="Preview">
        </div>

        <h3>Descripción</h3>
        <input type="text" name="descripcion" ngModel placeholder="Descripción">

        <button type="button" (click)="bajarPantalla()">Anterior</button>
        <button type="button" (click)="aumentarPantalla()">Siguiente</button>
      </div>
    </div>

    <!-- PANTALLA 2 -->
    <div [style.display]="seccionPantalla == 2 ? 'block' : 'none'" class="segunda-parte">
      <h3>Tipo de Local</h3>
      <select name="tipo" ngModel>
        <option value="">Seleccionar...</option>
        <option value="Local">Local</option>
        <option value="Restaurante">Restaurante</option>
        <option value="tienda">Tienda</option>
        <option value="bar">Bar</option>
      </select>

      <h3>Ubicación</h3>
      <div class="ubicacion-container">
        <div class="input-buscar">
          <input 
            type="text" 
            name="ubicacion" 
            [(ngModel)]="direccionInput" 
            placeholder="Ej: Av. Corrientes 1234, Buenos Aires"
            #ubicacionInput>
          <button 
            type="button" 
            (click)="buscarDireccionEnMapa()" 
            [disabled]="buscandoDireccion">
            {{ buscandoDireccion ? 'Buscando...' : 'Buscar en mapa' }}
          </button>
        </div>
        
        <p *ngIf="ubicacionConfirmada" class="ubicacion-confirmada">
          📍 Ubicación confirmada: {{ ubicacionConfirmada }}
        </p>

        <!-- Mapa integrado -->
        <app-mapa 
          [modo]="'vendedor'"
          [ubicacion]="coordenadasSeleccionadas"
          (ubicacionSeleccionada)="onUbicacionSeleccionada($event)"
          (direccionSeleccionada)="onDireccionSeleccionada($event)">
        </app-mapa>
      </div>

      <h3>Pre-Order?</h3>
      <label>
        <input type="checkbox" name="preorder" ngModel>
        Permitir pre-orden
      </label>

      <h3>Habilitar PS?</h3>
      <label>
        <input type="checkbox" name="psEnabled" ngModel [checked]="true">
        PS habilitado
      </label>
      <div *ngIf="comercioForm.value.psEnabled">
        <h3>Valor PS</h3>
        <input type="number" name="psValue" ngModel [value]="0" placeholder="0">
      </div>

      <h3>Métodos de Pago</h3>
      <label>
        <input type="checkbox" name="pagoEfectivo" ngModel [checked]="true">
        Efectivo
      </label>
      <label>
        <input type="checkbox" name="pagoDebito" ngModel [checked]="true">
        Débito
      </label>
      <label>
        <input type="checkbox" name="pagoCredito" ngModel [checked]="true">
        Crédito
      </label>
      <label>
        <input type="checkbox" name="pagoTransferencia" ngModel [checked]="true">
        Transferencia
      </label>

      <button type="button" (click)="bajarPantalla()">Anterior</button>
      <button type="button" (click)="aumentarPantalla()">Siguiente</button>
    </div>

    <!-- PANTALLA 3 -->
    <div [style.display]="seccionPantalla == 3 ? 'block' : 'none'" class="tercera-parte">
      <h2>Horarios</h2>
      <div *ngFor="let dia of dias; let i = index">
        <div class="TodaEstaCosa">
          <h1>{{dia}}</h1>
          <div class="horario-row">
            <label style="flex: 0 0 auto;">
              <input type="checkbox" name="si{{i}}" ngModel>
              Abierto
            </label>
            <input type="time" name="horaInicio{{i}}" ngModel placeholder="Desde">
            <input type="time" name="horaFin{{i}}" ngModel placeholder="Hasta">
          </div>
        </div>
      </div>

      <button type="button" (click)="bajarPantalla()">Anterior</button>
      <button type="submit">Crear Comercio</button>
    </div>

  </form>
</div>

<!-- Formulario para unirse -->
<div *ngIf="!creando && seccionPantalla == 0">
  <form (ngSubmit)="onSubmitUnirse(codigoForm)" #codigoForm="ngForm">
    <h3>Unirme a un local</h3>
    <input type="text" placeholder="Código del local" name="codigo" ngModel>
    <button type="submit">Entrar</button>
  </form>
</div>